<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Juego de vocabulario HSK </title>
<style>
  body { font-family: Arial, sans-serif; text-align:center; }
  .hidden { display:none; }

  /* â­â­â­ Level1 è‡ªé€‚åº”+å­—ä½“20%å¢å¼º â­â­â­ */
  #grid { 
    display:grid; 
    grid-template-columns:repeat(4, minmax(80px,1fr)); /* è‡ªåŠ¨é€‚é…åˆ—å®½ */
    gap:14px;                                          /* åŸ10pxâ†’æ”¾å¤§20% */
    max-width:80%;                                     /* ä¸¤ä¾§ç•™å‡ºâ‰ˆ3åˆ—å®½ */
    margin:30px auto;                                  /* å±…ä¸­+æ›´èˆ’é€‚è¾¹è· */
  }
  .card { 
    padding:24px;             /* åŸ20 â†’ +20% */
    font-size:24px;           /* åŸ20 â†’ +20% */
    background:#f0f0f0; 
    border-radius:12px;       /* åŸ10 â†’ +ç¾è§‚å¾®å¢åŠ  */
    cursor:pointer; 
    user-select:none; 
    transition:0.25s;         /* å¢åŠ è½»åŠ¨ç”» */
  }

  #timer,#progress { font-size:20px; margin:10px; }
  #level2 input { padding:8px; font-size:18px; }
  button { padding:8px 15px; margin:5px; font-size:16px; }
  #menu button { min-width:160px; }
  .invisible { visibility:hidden; }

  /* ------- è¿›åº¦æ¡æ ·å¼ ------- */
  #barBox {
    width: 80%;
    height: 20px;
    background: #ddd;
    margin: 10px auto;
    border-radius: 10px;
    overflow: hidden;
  }
  #bar {
    height: 100%;
    width: 0%;
    background: #4caf50;
    transition: width 0.4s;
  }
</style>
</head>
<body>
<h1>HSKè¯è¯­æ¸¸æˆ</h1>
<div id="timer">æ—¶é—´: 0 ç§’</div>
<div id="progress"></div>

<!-- å…³å¡é€‰æ‹© -->
<div id="menu">
  <button onclick="openLevel(1)">Emparejar</button>
  <button onclick="openLevel(2)">Escribir en chino</button>
</div>

<!-- ----------------- Level 1 æ¶ˆæ¶ˆä¹ ----------------- -->
<div id="level1" class="hidden">
  <h2>ç¬¬ä¸€å…³ï¼šEmparejar</h2>
  <div>
    <button onclick="startLevel1Run()">Empezar</button>
    <button onclick="prepareLevel1()">Reiniciar</button>
    <button onclick="goHome()">Volver</button>
  </div>
  <p id="summary1"></p>
  <div id="grid"></div>
</div>

<!-- ----------------- Level 2 è¾“å…¥ä¸­æ–‡ ----------------- -->
<div id="level2" class="hidden">
  <h2>ç¬¬äºŒå…³ï¼šEscribir en chino</h2>

  <!-- è¿›åº¦æ¡ -->
  <div id="barBox"><div id="bar"></div></div>

  <div>
    <button onclick="startLevel2Run()">Empezar</button>
    <button onclick="goHome()">Volver</button>
  </div>
  <p id="question"></p>
  <input id="answer" placeholder="æŒ‰å›è½¦æäº¤ï¼ˆEnterï¼‰" 
         onkeydown="if(event.key==='Enter') checkAnswer()" 
         disabled autocomplete="off">
  <div>
    <button onclick="showHint()">pista ğŸŒŸ</button>
    <button onclick="showFull()">soluciÃ³n ğŸŒŸğŸŒŸ</button>
  </div>
  <p id="feedback"></p>
  <p id="summary2"></p>
</div>

<script>
/* -------------------- è¯åº“ -------------------- */
const words = [
  {zh:"æ¡Œå­", es:"mesa", py:"zhuÅ zi"},
  {zh:"ä¸Š", es:"encima", py:"shÃ ng"},
  {zh:"ç”µè„‘", es:"ordenador", py:"diÃ n nÇo"},
  {zh:"å’Œ", es:"y", py:"hÃ©"},
  {zh:"æœ¬", es:"cuaderno", py:"bÄ›n"},
  {zh:"é‡Œ", es:"dentro", py:"lÇ"},
  {zh:"å‰é¢", es:"delante", py:"qiÃ¡n miÃ n"},
  {zh:"åé¢", es:"detrÃ¡s", py:"hÃ²u miÃ n"},
  {zh:"æœ‹å‹", es:"amigo", py:"pÃ©ng you"},
  {zh:"è¿™", es:"esto", py:"zhÃ¨"},
  {zh:"æ²¡æœ‰", es:"no tener", py:"mÃ©i yÇ’u"},
  {zh:"èƒ½", es:"poder", py:"nÃ©ng"},
  {zh:"å", es:"sentarse", py:"zuÃ²"},  
];

/* ----------------è®¡æ—¶å™¨---------------- */
let time = 0;
let timerInterval = null;
function updateTimerDisplay(){ document.getElementById('timer').innerText = `æ—¶é—´: ${time} ç§’`; }
function startTimer(){ if(timerInterval) return; timerInterval=setInterval(()=>{time++;updateTimerDisplay();},1000);}
function stopTimer(){ clearInterval(timerInterval); timerInterval=null; }
function resetTimer(){ stopTimer(); time=0; updateTimerDisplay(); }

/* ----------------å…³å¡åˆ‡æ¢---------------- */
function openLevel(n){
  document.getElementById('menu').classList.add('hidden');
  document.getElementById('progress').innerText = '';
  if(n===1){ document.getElementById('level1').classList.remove('hidden'); document.getElementById('level2').classList.add('hidden'); prepareLevel1();}
  if(n===2){ document.getElementById('level2').classList.remove('hidden'); document.getElementById('level1').classList.add('hidden'); prepareLevel2();}
}
function goHome(){
  stopTimer(); resetTimer();
  level1Active=false; level2Active=false;
  document.getElementById('menu').classList.remove('hidden');
  document.getElementById('level1').classList.add('hidden');
  document.getElementById('level2').classList.add('hidden');
  document.getElementById('summary1').innerText='';
  document.getElementById('summary2').innerText='';
}

/* ================== Level 1 ================== */
let pairs=[],selected=[],correct1=0,attempts1=0;
let grid=document.getElementById('grid');
let level1Active=false;

function prepareLevel1(){
  pairs=[]; words.forEach(w=>{pairs.push({t:w.zh,match:w.es});pairs.push({t:w.es,match:w.zh});});
  pairs.sort(()=>Math.random()-0.5);
  grid.innerHTML=''; correct1=0; attempts1=0; selected=[];
  level1Active=false; resetTimer(); document.getElementById('summary1').innerText='';

  pairs.forEach(p=>{
    const div=document.createElement('div');
    div.className='card'; div.innerText=p.t;
    div.dataset.match=p.match; div.dataset.active='false';
    div.onclick=()=>selectCard(div);
    grid.appendChild(div);
  });
}
function startLevel1Run(){
  level1Active=true;
  Array.from(grid.children).forEach(c=>c.dataset.active='true');
  resetTimer(); startTimer();
}
function selectCard(div){
  if(!level1Active) return;
  if(selected.length===2||div.classList.contains('done')||div.dataset.active!=='true') return;

  div.style.background='#cfc'; selected.push(div);

  if(selected.length===2){
    attempts1++;
    let [d0,d1]=selected;
    let match=d0.dataset.match===d1.innerText||d1.dataset.match===d0.innerText;

    if(match){
      selected.forEach(s=>{s.classList.add('done');s.style.visibility='hidden';s.dataset.active='false';});
      correct1++; selected=[];
      if(correct1===words.length){
        level1Active=false; stopTimer();
        document.getElementById('summary1').innerText=`å®Œæˆï¼${time}ç§’ï¼Œå°è¯•${attempts1}æ¬¡\nFinished ${time}s Attempts ${attempts1}`;
      }
    } else {
      /* âŒ ä½ è¦æ±‚çš„æ•ˆæœâ€”é”™è¯¯å…ˆå˜çº¢ï¼Œå†æ¢å¤ */
      selected.forEach(s=>s.style.background='#f99');
      setTimeout(()=>{ selected.forEach(s=>s.style.background='#f0f0f0'); selected=[] },500);
    }
  }
}

/* ================== Level 2 ================== */
let index=0,order=[],correct2=0,attempts2=0,level2Active=false;

function prepareLevel2(){
  order=[...words].sort(()=>Math.random()-0.5);
  index=0;correct2=0;attempts2=0;level2Active=false;
  document.getElementById('answer').disabled=true;
  document.getElementById('answer').value='';
  document.getElementById('feedback').innerText='';
  document.getElementById('summary2').innerText='';
  updateBar(); loadQ();
}
function startLevel2Run(){
  level2Active=true;
  document.getElementById('answer').disabled=false;
  document.getElementById('answer').focus();
  resetTimer(); startTimer();
}

/* --- è¿›åº¦æ¡ --- */
function updateBar(){ document.getElementById('bar').style.width=(index/words.length)*100+"%"; }

function loadQ(){
  document.getElementById('question').innerHTML=`å†™ä¸­æ–‡:<br><span style="font-size:28px;">${order[index].es}</span>`;
  document.getElementById('answer').value='';
  document.getElementById('feedback').innerText='';
}

function checkAnswer(){
  if(!level2Active) return;
  const a=document.getElementById('answer').value.trim();
  attempts2++;

  if(a===order[index].zh){
    document.getElementById('feedback').innerText='å¥½å‰å®³ Muy bien!';
    correct2++; index++; updateBar();

    if(index===order.length){
      level2Active=false; stopTimer(); updateBar();
      document.getElementById('summary2').innerText=
      `å®Œæˆ:${correct2}/${order.length} ç”¨æ—¶${time}ç§’ Intentos:${attempts2}`;
    }else setTimeout(loadQ,600);

  }else document.getElementById('feedback').innerText='ä¸æ­£ç¡®âŒ intÃ©ntalo otra vez';
}

function showHint(){
  if(!level2Active) return;
  let zh=order[index].zh;
  let py=order[index].py.split(" ").map(p=>p[0]+"...").join(" ");
  document.getElementById('feedback').innerHTML=`${zh}<br>${py}`;
}
function showFull(){
  if(!level2Active) return;
  document.getElementById('feedback').innerText=`${order[index].zh} (${order[index].py})`;
}

/* åˆå§‹åŒ– */
prepareLevel1();
</script>
</body>
</html>
